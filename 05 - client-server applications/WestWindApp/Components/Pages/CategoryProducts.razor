@page "/categoryproducts"
<PageTitle>Category Products</PageTitle>
@rendermode InteractiveServer
@using WestWindSystem.Entities;
@using WestWindSystem.BLL;

<h1>Category Products</h1>
<h4>... select category to view products</h4>

<!-- area to feedback messages-->
@if (feedBackMessage.Length > 0)
{
    <div class="alert alert-info">
        <p>@feedBackMessage</p>
    </div>
}
<!-- area to error messages-->
@if (errorMsgs.Count > 0)
{
    <div class="alert alert-danger">
        <p>Please fix the following issues:</p>
        <ul>
            @foreach (var error in errorMsgs)
            {
                <li>@error</li>
            }
        </ul>
    </div>
}


<div class="row">
    <div class="col-md-12">
        <label for="catlist">Select Product Category:</label>
        &nbsp;&nbsp;
        <select id="catlist" @bind="CategoryId">
            <option value="0">select category ...</option>
            @foreach (var cat in categoryList)
            {
                <option value="@cat.CategoryID">@cat.CategoryName</option>
            }
        </select>
        &nbsp;&nbsp;
        @* Here, we're demoing two different ways of doing routing:
            1. Blazor NavLink component
            2. NavigationManager & method handler
        *@
        <button type="submit" class="btn btn-outline-secondary rounded-pill">
            <NavLink href="productcrud">CRUD via NavLink component</NavLink>
        </button>

        <button type="submit" class="btn btn-outline-secondary rounded-pill" @onclick="GoToCRUD">
            CRUD via event
        </button>
     </div>
</div>



@code {

    private string feedBackMessage = "";
    private List<string> errorMsgs { get; set; } = new List<string>();

    //inject the CategoryService into the page
    //this will allow access to the methods in the CategoryService BLL class
    [Inject]
    private CategoryServices _categoryServices { get; set; }
    private List<Category> categoryList { get; set; }
    private int CategoryId { get; set; }

    //inject the ProductService into the page
    [Inject]
    private ProductServices _productServices { get; set; }
    private List<Product> productList { get; set; } 


    //inject the SupplyService into the page
    [Inject]
    private SupplierServices _supplierServices { get; set; }
    private List<Supplier> supplierList { get; set; }

    //inject NavigationManager to handle our event-based link routing
    [Inject]
    private NavigationManager _navManager { get; set; }

    protected override void OnInitialized()
    {
        base.OnInitialized();
        //retrieve the list of category via the CategoryServices in your BLL
        categoryList = _categoryServices.Category_GetAll();
        //retrieve the list of supplier via the SupplierServices in your BLL
        supplierList = _supplierServices.Supplier_GetAll();

    }

    private void GoToCRUD()
    {
        _navManager.NavigateTo("/productcrud");
    }

}